<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админ панель - GOOD TEAM CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        .particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .content-container {
            position: relative;
            z-index: 10;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .animate-in {
            opacity: 0;
            transform: translateY(20px);
        }
        
        .sidebar-item {
            transition: all 0.3s ease;
        }
        
        .sidebar-item:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: translateX(5px);
        }
        
        .sidebar-item.active {
            background: rgba(59, 130, 246, 0.2);
            border-right: 3px solid #3b82f6;
        }
        
        .metric-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            backdrop-filter: blur(10px);
        }
        
        .notification-badge {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container"></div>
    
    <!-- Main Content -->
    <div class="content-container">
        <!-- Navigation -->
        <nav class="bg-white/80 backdrop-blur-lg border-b border-gray-200 sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center space-x-4">
                        <img src="resources/logo.png" alt="GOOD TEAM" class="h-8 w-8">
                        <h1 class="text-xl font-bold text-gray-900">GOOD TEAM CRM</h1>
                        <span class="text-sm text-gray-500">Админ панель</span>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <!-- Notification Bell -->
                        <button id="notificationBell" class="relative p-2 text-gray-600 hover:text-gray-900 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM10.5 3.5a6 6 0 0 1 6 6v1.5a6 6 0 0 0 2.5 4.5H6a6 6 0 0 0 2.5-4.5V9.5a6 6 0 0 1 6-6z"></path>
                            </svg>
                            <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center notification-badge" style="display: none;">0</span>
                        </button>
                        
                        <!-- User Profile -->
                        <div class="flex items-center space-x-3">
                            <img id="currentUserAvatar" src="resources/user-avatars/avatar1.jpg" alt="User" class="h-8 w-8 rounded-full">
                            <div>
                                <p id="currentUserName" class="text-sm font-medium text-gray-900">Александр Петров</p>
                                <p id="currentUserRole" class="text-xs text-gray-500">Администратор</p>
                            </div>
                            <button id="logoutBtn" class="text-gray-600 hover:text-gray-900 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="flex">
            <!-- Sidebar -->
            <div class="w-64 bg-white/80 backdrop-blur-lg border-r border-gray-200 min-h-screen">
                <div class="p-4">
                    <nav class="space-y-2">
                        <a href="#dashboard" class="sidebar-item active flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                            </svg>
                            <span>Обзор</span>
                        </a>
                        
                        <a href="#users" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                            </svg>
                            <span>Пользователи</span>
                        </a>
                        
                        <a href="#leads" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>Все лиды</span>
                        </a>
                        
                        <a href="#analytics" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            <span>Аналитика</span>
                        </a>
                        
                        <a href="#scripts" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>Скрипты</span>
                        </a>
                        
                        <a href="#salaries" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-gray-900">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                            </svg>
                            <span>Зарплаты</span>
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1 p-6">
                <!-- Dashboard Overview -->
                <div id="dashboard" class="section-content">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Обзор системы</h2>
                        <p class="text-gray-600">Ключевые показатели и метрики колл-центра</p>
                    </div>

                    <!-- Metrics Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <!-- Total Users -->
                        <div class="metric-card rounded-2xl p-6 card-hover animate-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Всего операторов</p>
                                    <p id="totalUsers" class="text-3xl font-bold text-gray-900">5</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <!-- Total Leads -->
                        <div class="metric-card rounded-2xl p-6 card-hover animate-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Всего лидов</p>
                                    <p id="totalLeads" class="text-3xl font-bold text-gray-900">2</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue -->
                        <div class="metric-card rounded-2xl p-6 card-hover animate-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Выручка</p>
                                    <p id="totalRevenue" class="text-3xl font-bold text-gray-900">₽75,000</p>
                                </div>
                                <div class="w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <!-- Active Operators -->
                        <div class="metric-card rounded-2xl p-6 card-hover animate-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Активных операторов</p>
                                    <p id="activeOperators" class="text-3xl font-bold text-gray-900">5</p>
                                </div>
                                <div class="w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <!-- Leads Chart -->
                        <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 card-hover animate-in">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Динамика лидов</h3>
                            <div id="leadsChart" style="height: 300px;"></div>
                        </div>

                        <!-- Revenue Chart -->
                        <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 card-hover animate-in">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Выручка по месяцам</h3>
                            <div id="revenueChart" style="height: 300px;"></div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 card-hover animate-in">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Последняя активность</h3>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-lg">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Добавлен новый оператор</p>
                                    <p class="text-xs text-gray-500">Мария Иванова - TTC Оператор</p>
                                </div>
                                <span class="text-xs text-gray-400">2 часа назад</span>
                            </div>
                            
                            <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-lg">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Новый лид добавлен</p>
                                    <p class="text-xs text-gray-500">ИП Ромашка ООО - ₽50,000</p>
                                </div>
                                <span class="text-xs text-gray-400">4 часа назад</span>
                            </div>
                            
                            <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-lg">
                                <div class="w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Звонок обработан</p>
                                    <p class="text-xs text-gray-500">Елена Волкова - статус: Успешно</p>
                                </div>
                                <span class="text-xs text-gray-400">6 часов назад</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users Management Section -->
                <div id="users" class="section-content hidden">
                    <div class="mb-8">
                        <div class="flex justify-between items-center">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-900 mb-2">Управление пользователями</h2>
                                <p class="text-gray-600">Добавление, редактирование и удаление операторов</p>
                            </div>
                            <button onclick="showAddUserModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                Добавить пользователя
                            </button>
                        </div>
                    </div>

                    <!-- Users Table -->
                    <div class="bg-white/80 backdrop-blur-lg rounded-2xl overflow-hidden card-hover animate-in">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Пользователь</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Роль</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Дата найма</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ставка</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Статус</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Users will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Other sections will be added in the same pattern -->
                <div id="leads" class="section-content hidden">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Все лиды</h2>
                        <p class="text-gray-600">Управление всеми лидами в системе</p>
                    </div>
                    
                    <div class="bg-white/80 backdrop-blur-lg rounded-2xl overflow-hidden card-hover animate-in">
                        <div class="p-4 border-b border-gray-200">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">Список лидов</h3>
                                <div class="flex space-x-2">
                                    <input type="text" placeholder="Поиск..." class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                    <select class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                        <option>Все статусы</option>
                                        <option>Новый</option>
                                        <option>В работе</option>
                                        <option>Завершен</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Лид</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Менеджер</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Сумма</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Статус</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Дата</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="leadsTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Leads will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Analytics Section -->
                <div id="analytics" class="section-content hidden">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Аналитика</h2>
                        <p class="text-gray-600">Детальная аналитика по операторам и лидам</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 card-hover animate-in">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Эффективность операторов</h3>
                            <div id="operatorChart" style="height: 300px;"></div>
                        </div>
                        
                        <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 card-hover animate-in">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Конверсия по этапам</h3>
                            <div id="conversionChart" style="height: 300px;"></div>
                        </div>
                    </div>
                </div>

                <!-- Scripts Section -->
                <div id="scripts" class="section-content hidden">
                    <div class="mb-8">
                        <div class="flex justify-between items-center">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-900 mb-2">Скрипты</h2>
                                <p class="text-gray-600">Управление скриптами для операторов</p>
                            </div>
                            <button onclick="showAddScriptModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                Добавить скрипт
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white/80 backdrop-blur-lg rounded-2xl overflow-hidden card-hover animate-in">
                        <div class="p-4 border-b border-gray-200">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">Список скриптов</h3>
                                <div class="flex space-x-2">
                                    <input type="text" placeholder="Поиск скриптов..." class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                    <select class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                        <option>Все категории</option>
                                        <option>Знакомство</option>
                                        <option>Возражения</option>
                                        <option>Закрытие</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="divide-y divide-gray-200">
                            <div id="scriptsList" class="divide-y divide-gray-200">
                                <!-- Scripts will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Salaries Section -->
                <div id="salaries" class="section-content hidden">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Управление зарплатами</h2>
                        <p class="text-gray-600">Расчет и управление зарплатами операторов</p>
                    </div>
                    
                    <div class="bg-white/80 backdrop-blur-lg rounded-2xl overflow-hidden card-hover animate-in">
                        <div class="p-4 border-b border-gray-200">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">Зарплата за ноябрь 2024</h3>
                                <div class="flex space-x-2">
                                    <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                        Экспорт в Excel
                                    </button>
                                    <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                        Рассчитать премии
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Сотрудник</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Базовая ставка</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Премия</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Удержания</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Итого</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Статус</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="salariesTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Salaries will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals will be added here -->
    <div id="modalContainer"></div>

    <!-- JavaScript -->
    <script src="main.js"></script>
    
    <script>
        // Admin specific functionality
        class AdminDashboard {
            constructor() {
                this.currentSection = 'dashboard';
                this.init();
            }

            init() {
                this.setupNavigation();
                this.loadDashboard();
                this.loadUsersTable();
                this.loadLeadsTable();
                this.loadScriptsList();
                this.loadSalariesTable();
                this.initializeCharts();
            }

            setupNavigation() {
                const sidebarItems = document.querySelectorAll('.sidebar-item');
                sidebarItems.forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = item.getAttribute('href').substring(1);
                        this.showSection(section);
                    });
                });
            }

            showSection(sectionName) {
                // Hide all sections
                document.querySelectorAll('.section-content').forEach(section => {
                    section.classList.add('hidden');
                });

                // Show selected section
                const targetSection = document.getElementById(sectionName);
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                    this.currentSection = sectionName;
                }

                // Update active sidebar item
                document.querySelectorAll('.sidebar-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                const activeItem = document.querySelector(`[href="#${sectionName}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
            }

            loadDashboard() {
                // Update metrics
                const users = window.crm?.users || [];
                const leads = window.crm?.leads || [];
                
                document.getElementById('totalUsers').textContent = users.length;
                document.getElementById('totalLeads').textContent = leads.length;
                
                const revenue = leads.filter(lead => lead.paymentStatus === 'paid')
                    .reduce((sum, lead) => sum + (lead.paymentAmount || 0), 0);
                document.getElementById('totalRevenue').textContent = formatCurrency(revenue);
                
                document.getElementById('activeOperators').textContent = 
                    users.filter(user => user.status === 'active').length;
            }

            loadUsersTable() {
                const users = window.crm?.users || [];
                const tbody = document.getElementById('usersTableBody');
                
                tbody.innerHTML = users.map(user => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <img class="h-8 w-8 rounded-full" src="${user.avatar || 'resources/user-avatars/default.jpg'}" alt="">
                                <div class="ml-3">
                                    <div class="text-sm font-medium text-gray-900">${user.name}</div>
                                    <div class="text-sm text-gray-500">${user.email}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                user.role === 'admin' ? 'bg-red-100 text-red-800' :
                                user.role === 'ttc' ? 'bg-blue-100 text-blue-800' :
                                'bg-green-100 text-green-800'
                            }">
                                ${window.crm?.getRoleName(user.role) || user.role}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${formatDate(user.hireDate)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(user.salaryRate)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                user.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'
                            }">
                                ${user.status === 'active' ? 'Активен' : 'Неактивен'}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="editUser(${user.id})" class="text-blue-600 hover:text-blue-900 mr-3">Редактировать</button>
                            <button onclick="deleteUser(${user.id})" class="text-red-600 hover:text-red-900">Удалить</button>
                        </td>
                    </tr>
                `).join('');
            }

            loadLeadsTable() {
                const leads = window.crm?.leads || [];
                const tbody = document.getElementById('leadsTableBody');
                
                tbody.innerHTML = leads.map(lead => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${lead.leadName}</div>
                            <div class="text-sm text-gray-500">${lead.phoneNumber}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${lead.manager}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(lead.paymentAmount || 0)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${getStatusColor(lead.status)}-100 text-${getStatusColor(lead.status)}-800">
                                ${lead.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${formatDate(lead.timestamp)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="viewLead(${lead.id})" class="text-blue-600 hover:text-blue-900 mr-3">Просмотр</button>
                            <button onclick="editLead(${lead.id})" class="text-amber-600 hover:text-amber-900">Редактировать</button>
                        </td>
                    </tr>
                `).join('');
            }

            loadScriptsList() {
                const scripts = window.crm?.scripts || [];
                const container = document.getElementById('scriptsList');
                
                container.innerHTML = scripts.map(script => `
                    <div class="p-6 hover:bg-gray-50">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="text-lg font-medium text-gray-900 mb-2">${script.scriptName}</h4>
                                <p class="text-sm text-gray-500 mb-3">Категория: ${script.category}</p>
                                <p class="text-sm text-gray-700 line-clamp-3">${script.scriptContent}</p>
                            </div>
                            <div class="flex space-x-2 ml-4">
                                <button onclick="editScript(${script.id})" class="text-blue-600 hover:text-blue-900 text-sm">Редактировать</button>
                                <button onclick="deleteScript(${script.id})" class="text-red-600 hover:text-red-900 text-sm">Удалить</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            loadSalariesTable() {
                const users = window.crm?.users || [];
                const tbody = document.getElementById('salariesTableBody');
                
                tbody.innerHTML = users.map(user => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <img class="h-8 w-8 rounded-full" src="${user.avatar || 'resources/user-avatars/default.jpg'}" alt="">
                                <div class="ml-3">
                                    <div class="text-sm font-medium text-gray-900">${user.name}</div>
                                    <div class="text-sm text-gray-500">${window.crm?.getRoleName(user.role) || user.role}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(user.salaryRate)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(Math.floor(user.salaryRate * 0.2))}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(0)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatCurrency(Math.floor(user.salaryRate * 1.2))}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                Ожидает выплаты
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="paySalary(${user.id})" class="text-green-600 hover:text-green-900 mr-3">Выплатить</button>
                            <button onclick="editSalary(${user.id})" class="text-blue-600 hover:text-blue-900">Редактировать</button>
                        </td>
                    </tr>
                `).join('');
            }

            initializeCharts() {
                // Initialize leads chart
                const leadsChart = echarts.init(document.getElementById('leadsChart'));
                leadsChart.setOption({
                    tooltip: { trigger: 'axis' },
                    xAxis: {
                        type: 'category',
                        data: ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс']
                    },
                    yAxis: { type: 'value' },
                    series: [{
                        data: [12, 8, 15, 10, 18, 6, 4],
                        type: 'line',
                        smooth: true,
                        itemStyle: { color: '#3b82f6' },
                        areaStyle: { opacity: 0.3 }
                    }]
                });

                // Initialize revenue chart
                const revenueChart = echarts.init(document.getElementById('revenueChart'));
                revenueChart.setOption({
                    tooltip: { trigger: 'axis' },
                    xAxis: {
                        type: 'category',
                        data: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн']
                    },
                    yAxis: { type: 'value' },
                    series: [{
                        data: [45000, 52000, 48000, 61000, 55000, 75000],
                        type: 'bar',
                        itemStyle: { color: '#10b981' }
                    }]
                });

                // Initialize operator chart
                const operatorChart = echarts.init(document.getElementById('operatorChart'));
                operatorChart.setOption({
                    tooltip: { trigger: 'item' },
                    series: [{
                        type: 'pie',
                        radius: '70%',
                        data: [
                            { value: 35, name: 'Мария Иванова' },
                            { value: 28, name: 'Дмитрий Соколов' },
                            { value: 22, name: 'Елена Волкова' },
                            { value: 15, name: 'Андрей Морозов' }
                        ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }]
                });

                // Initialize conversion chart
                const conversionChart = echarts.init(document.getElementById('conversionChart'));
                conversionChart.setOption({
                    tooltip: { trigger: 'item' },
                    series: [{
                        type: 'funnel',
                        left: '10%',
                        top: 60,
                        bottom: 60,
                        width: '80%',
                        data: [
                            { value: 100, name: 'Новые лиды' },
                            { value: 80, name: 'Контакт установлен' },
                            { value: 60, name: 'Презентация' },
                            { value: 40, name: 'Переговоры' },
                            { value: 25, name: 'Закрытые сделки' }
                        ]
                    }]
                });
            }
        }

        // Modal functions
        function showAddUserModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 max-h-96 overflow-y-auto">
                    <h3 class="text-2xl font-bold mb-6">Добавить пользователя</h3>
                    <form id="addUserForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Имя</label>
                            <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Роль</label>
                            <select name="role" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="ttc">TTC Оператор</option>
                                <option value="callcenter">Call Center Оператор</option>
                                <option value="admin">Администратор</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Базовая ставка</label>
                            <input type="number" name="salaryRate" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div class="flex space-x-3 pt-4">
                            <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg">Добавить</button>
                            <button type="button" onclick="this.parentElement.parentElement.parentElement.parentElement.remove()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Отмена</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);

            document.getElementById('addUserForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const userData = Object.fromEntries(formData.entries());
                userData.salaryRate = parseInt(userData.salaryRate);
                
                if (window.crm) {
                    window.crm.addUser(userData);
                    window.crm.loadUsersTable();
                }
                
                modal.remove();
            });
        }

        function showAddScriptModal() {
            // Similar implementation for adding scripts
            window.crm?.showNotification('Функция добавления скриптов в разработке', 'info');
        }

        function editUser(userId) {
            window.crm?.showNotification('Функция редактирования в разработке', 'info');
        }

        function deleteUser(userId) {
            if (confirm('Вы уверены, что хотите удалить этого пользователя?')) {
                window.crm?.deleteUser(userId);
                window.crm?.loadUsersTable();
            }
        }

        function viewLead(leadId) {
            window.crm?.showNotification('Функция просмотра лида в разработке', 'info');
        }

        function editLead(leadId) {
            window.crm?.showNotification('Функция редактирования лида в разработке', 'info');
        }

        function editScript(scriptId) {
            window.crm?.showNotification('Функция редактирования скрипта в разработке', 'info');
        }

        function deleteScript(scriptId) {
            window.crm?.showNotification('Функция удаления скрипта в разработке', 'info');
        }

        function paySalary(userId) {
            window.crm?.showNotification('Зарплата выплачена', 'success');
        }

        function editSalary(userId) {
            window.crm?.showNotification('Функция редактирования зарплаты в разработке', 'info');
        }

        // Initialize admin dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            if (window.crm && window.crm.currentUser && window.crm.currentUser.role === 'admin') {
                new AdminDashboard();
            } else {
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>